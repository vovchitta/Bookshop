(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var r=t.g.document;if(!e&&r&&(r.currentScript&&"SCRIPT"===r.currentScript.tagName.toUpperCase()&&(e=r.currentScript.src),!e)){var o=r.getElementsByTagName("script");if(o.length)for(var n=o.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=o[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const e=t.p+"images/black-friday-banner.jpg",r=t.p+"images/top10-banner.jpg",o=t.p+"images/book-collection-banner.jpg";!function(){const t=document.createElementNS("http://www.w3.org/2000/svg","defs");for(let e=0;e<=10;e++){let r=10*e,o=document.createElementNS("http://www.w3.org/2000/svg","linearGradient");o.setAttribute("id",`gradient-${r}`),o.setAttribute("x1","0%"),o.setAttribute("y1","0%"),o.setAttribute("x2","100%"),o.setAttribute("y2","0%");let n=document.createElementNS("http://www.w3.org/2000/svg","stop");n.setAttribute("offset",`${r}%`),n.setAttribute("stop-color","#F2C94C");let i=document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset",`${r}%`),i.setAttribute("stop-color","#EEEDF5"),o.appendChild(n),o.appendChild(i),t.appendChild(o)}document.querySelector(".star").appendChild(t)}();const n=new class{constructor(){this.slides=[e,r,o],this.switchers=Array.from(document.querySelectorAll(".switcher")),this.banner=document.querySelector(".slider-banner"),this.currentSlide=0,this.startSwitch=null}autoSwitcher(){clearInterval(this.startSwitch),this.startSwitch=setInterval((()=>{this.updateSlide((this.currentSlide+1)%this.slides.length)}),5e3)}updateSlide(t){this.currentSlide=t,this.banner.style.backgroundImage=`url(${this.slides[t]})`,this.switchers.forEach(((e,r)=>{e.style.backgroundColor=r===t?"#9E98DC":"#EFEEF6"}))}addSwitchListeners(){this.switchers.forEach(((t,e)=>{t.addEventListener("click",(()=>{this.updateSlide(e),this.autoSwitcher()}))}))}},i=new class{constructor(){this.library=[]}getBooks(t,e){return fetch(`https://www.googleapis.com/books/v1/volumes?q="subject:${t}"&key=AIzaSyDpJNMouQ5hrH0v1FwmHHC5hIn68XRxzAg&printType=books&startIndex=0&maxResults=${e}`).then((t=>t.json())).then((t=>{console.log(t),t.items&&t.items.length>0&&(this.library=t.items.map((t=>({picture:t.volumeInfo.imageLinks?.thumbnail||null,author:t.volumeInfo.authors||"The author is not specified",bookName:t.volumeInfo.title||"Unnamed",averageRating:t.volumeInfo.averageRating||null,rating:t.volumeInfo.ratingsCount||0,description:t.volumeInfo.description||null,price:t.saleInfo?.retailPrice?.amount||null}))))})).catch((t=>{console.error("Ошибка при загрузке данных:",t)}))}},c=new class{constructor(){}loadMoreBooks(){const t=document.querySelector(".book-cards__container");for(let e=0;e<6;e++)t.insertAdjacentHTML("beforeend",'\n                <div class="book-card">\n                    <div class="book-card__cover"></div>\n                    <div class="book-card__filling">\n                        <div class="book-card__autor"></div>\n                        <div class="book-card__name"></div>\n                        <div class="book-card__review">\n                            <svg class="star" sequence-number="1" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                    <path d="M6 0L7.80568 3.5147L11.7063 4.1459L8.92165 6.9493L9.52671 10.8541L6 9.072L2.47329 10.8541L3.07835 6.9493L0.293661 4.1459L4.19432 3.5147L6 0Z" fill="#EEEDF5"/>\n                                </svg>\n                                <svg class="star" sequence-number="2" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                    <path d="M6 0L7.80568 3.5147L11.7063 4.1459L8.92165 6.9493L9.52671 10.8541L6 9.072L2.47329 10.8541L3.07835 6.9493L0.293661 4.1459L4.19432 3.5147L6 0Z" fill="#EEEDF5"/>\n                                </svg>\n                                <svg class="star" sequence-number="3" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                    <path d="M6 0L7.80568 3.5147L11.7063 4.1459L8.92165 6.9493L9.52671 10.8541L6 9.072L2.47329 10.8541L3.07835 6.9493L0.293661 4.1459L4.19432 3.5147L6 0Z" fill="#EEEDF5"/>\n                                </svg>\n                                <svg class="star" sequence-number="4" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                    <path d="M6 0L7.80568 3.5147L11.7063 4.1459L8.92165 6.9493L9.52671 10.8541L6 9.072L2.47329 10.8541L3.07835 6.9493L0.293661 4.1459L4.19432 3.5147L6 0Z" fill="#EEEDF5"/>\n                                </svg>\n                                <svg class="star" sequence-number="5" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                    <path d="M6 0L7.80568 3.5147L11.7063 4.1459L8.92165 6.9493L9.52671 10.8541L6 9.072L2.47329 10.8541L3.07835 6.9493L0.293661 4.1459L4.19432 3.5147L6 0Z" fill="#EEEDF5"/>\n                                </svg>\n                            <div class="book-card__text"></div>\n                        </div>\n                        <div class="book-card__description"></div>\n                        <div class="book-card__price"></div>\n                        <button class="book-card__buy-btn btn">buy now</button>\n                    </div>\n                </div>')}},a=new class{constructor(){this.headerBurger=document.querySelector(".header-burger__svg"),this.headerMenu=document.querySelector(".mobile__header-nav"),this.mainBurger=document.querySelector(".main-burger__svg"),this.mainMenu=document.querySelector(".mobile__sorting-list"),this.isHeaderActive="false",this.isMainActive="false"}burgerListener(){this.headerBurger.addEventListener("click",(()=>{"false"===this.isHeaderActive?(this.headerMenu.style.display="flex",this.isHeaderActive="true"):(this.headerMenu.style.display="none",this.isHeaderActive="false")})),this.mainBurger.addEventListener("click",(()=>{"false"===this.isMainActive?(this.mainMenu.style.display="block",this.isMainActive="true"):(this.mainMenu.style.display="none",this.isMainActive="false")}))}};n.autoSwitcher(),n.addSwitchListeners();const s=document.querySelector(".load-more-btn"),l=document.querySelectorAll(".category");let u=6,d="Architecture";const h=[];function b(){const t=document.querySelectorAll(".book-card > .book-card__cover"),e=document.querySelectorAll(".book-card > .book-card__filling > .book-card__autor"),r=document.querySelectorAll(".book-card > .book-card__filling > .book-card__name"),o=document.querySelectorAll(".book-card"),n=document.querySelectorAll(".book-card > .book-card__filling > .book-card__review > .book-card__text"),c=document.querySelectorAll(".book-card > .book-card__filling > .book-card__description"),a=document.querySelectorAll(".book-card > .book-card__filling > .book-card__price");t.forEach(((t,e)=>{const r=i.library[e];r&&r.picture&&(t.style.backgroundImage=`url(${r.picture})`)})),e.forEach(((t,e)=>{const r=i.library[e];r&&(t.textContent=r.author)})),r.forEach(((t,e)=>{const r=i.library[e];r&&(t.textContent=r.bookName)})),o.forEach(((t,e)=>{const r=i.library[e];r&&t.setAttribute("avg-rating",r.averageRating)})),n.forEach(((t,e)=>{const r=i.library[e];r&&(t.textContent=`${r.rating} review`)})),c.forEach(((t,e)=>{const r=i.library[e];r&&(t.textContent=r.description)})),a.forEach(((t,e)=>{const r=i.library[e];r&&(r.price?t.textContent=r.price:t.remove())}))}function g(){document.querySelectorAll(".book-card__buy-btn").forEach((t=>{t.removeEventListener("click",m),t.addEventListener("click",m)}))}function m(t){const e=t.currentTarget,r=e.closest(".book-card__filling"),o=r.querySelector(".book-card__autor").textContent,n=r.querySelector(".book-card__name").textContent,i=h.findIndex((t=>t.author===o&&t.name===n));"true"===e.getAttribute("data-in-cart")?(-1!==i&&h.splice(i,1),e.textContent="buy now",e.setAttribute("data-in-cart","false")):(-1===i&&h.push({author:o,name:n}),e.textContent="remove from cart",e.setAttribute("data-in-cart","true")),p(),w()}function v(){document.querySelectorAll(".book-card__filling").forEach((t=>{let e=t.querySelector(".book-card__autor").textContent,r=t.querySelector(".book-card__name").textContent,o=t.querySelector(".book-card__buy-btn");-1!==h.findIndex((t=>t.author===e&&t.name===r))?(o.textContent="remove from cart",o.setAttribute("data-in-cart","true")):(o.textContent="buy now",o.setAttribute("data-in-cart","false"))})),p()}function f(){document.querySelectorAll(".book-card").forEach((t=>{let e=t.getAttribute("avg-rating");t.querySelectorAll(".star").forEach((t=>{let r=t.getAttribute("sequence-number");e<=r-1||"null"===e?t.querySelector("path").setAttribute("fill","url(#gradient-0)"):e>=r?t.querySelector("path").setAttribute("fill","url(#gradient-100)"):t.querySelector("path").setAttribute("fill",`url(#gradient-${100*(e-(r-1))})`)}))}))}function p(){localStorage.setItem("cart",JSON.stringify(h))}function w(){document.querySelector(".cart").textContent=h.length}h.length=0,h.push(...JSON.parse(localStorage.getItem("cart")||"[]")),g(),a.burgerListener(),i.getBooks(d,36).then((()=>{b(),f(),v(),w()})),s.addEventListener("click",(()=>{c.loadMoreBooks(),u+=6,i.getBooks(d,36).then((()=>{b(),g(),f(),v()})),36===u&&(s.disabled=!0,s.style.cursor="not-allowed",s.textContent="No more books in this category")})),l.forEach((t=>{t.addEventListener("click",(t=>{const e=t.currentTarget;d=e.id,i.getBooks(d,36).then((()=>{b(),g(),f(),v()})),l.forEach((t=>{t.className="category"})),e.className="category active"}))}))})();